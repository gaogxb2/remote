# 测试用例分析

## 测试用例1: 输入123左移4回车

### 输入序列：
1. 按键 "1"
2. 按键 "2"  
3. 按键 "3"
4. 光标左移 1 次
5. 按键 "4"
6. 回车

### 设备输出序列（解码后）：
1. `'1'` - 设备回显 "1"
2. `'2'` - 设备回显 "2"
3. `'3'` - 设备回显 "3"
4. `'\x08'` - 退格字符（设备响应光标左移）
5. `'43\x08'` - 设备回显 "43" 然后退格（可能是设备处理输入 "4" 时的回显）
6. `'3\r\n-/bin'` - 回车后，设备输出 "3" 换行，然后输出 "-/bin"（注意这里输出的是 "3" 而不是 "1243"，说明设备可能没有正确处理输入）
7. `'/bash: 1'` - 继续输出 "/bash: 1"
8. `'243: not found\r\n'` - 输出 "243: not found" 换行（注意是 "243" 不是 "1243"）
9. `'\x1b[32mROU'` - ANSI 绿色开始，输出 "ROU"
10. `'TER_MP\nU/\x1b[m #'` - 输出 "TER_MP" 换行 "U/" 然后结束 ANSI，输出 " #"

### 预期显示：
```
1243
-/bin/bash: 1243: not found
ROUTER_MPU / #
```

### 分析：

根据预期显示，应该是：
- 输入 "123" 后光标左移，然后输入 "4"，应该得到 "1243"（在 "3" 的位置插入 "4"，变成 "1243"）
- 回车后，设备输出错误信息：`-/bin/bash: 1243: not found`
- 然后输出提示符：`ROUTER_MPU / #`（绿色）

但实际设备输出显示：
- 设备输出的是 "3" 而不是 "1243"
- 错误信息是 "243: not found" 而不是 "1243: not found"

这说明：
1. 设备可能没有正确处理输入，或者
2. 测试用例中的设备输出序列可能不准确

### 需要检查的代码逻辑：

1. **输入处理**：
   - 输入 "123" 后，`input_buffer` 应该是 `['1', '2', '3']`，`input_cursor` 应该是 3
   - 光标左移后，`input_cursor` 应该是 2
   - 输入 "4" 后，`input_buffer` 应该是 `['1', '2', '4', '3']`，`input_cursor` 应该是 3

2. **设备输出处理**：
   - `'\x08'` 应该触发退格处理，修改 `input_buffer` 和 `input_cursor`
   - `'43\x08'` 应该先插入 "43"，然后退格
   - ANSI 序列应该被正确解析和显示

3. **最终显示**：
   - 应该只显示从开始到 `input_start_mark` 之前的内容
   - 不应该包含输入缓冲的内容

